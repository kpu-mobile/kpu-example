
/**
 * 由 Kpu-mobile 提供技术支持
 * Powered by Kpu-mobile
 * https://kpu-mobile.kpui.top/
 */
    
import{_}from"./index-Czg9Ols8.js";import{d as K,A as E,bp as $,k as b,o,C as A,u as l,g as M,ad as R,bl as U,bm as j,c as m,w as e,a as n,p as k,e as t,F as q,n as z,b as i,_ as G,t as B,a3 as y}from"./index-CEhcQr1Q.js";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang-CIWwt91K.js";import{s as C}from"./function-call-D3B_gvgw.js";const I={class:"contents"},J=K({name:"KmAuth",__name:"index",props:{value:{},all:{type:Boolean}},setup(P){const r=P,a=E(()=>r.all?$().authAll(typeof r.value=="string"?[r.value]:r.value):$().auth(r.value));return(u,S)=>(o(),b("div",I,[l(a)?A(u.$slots,"default",{key:0}):A(u.$slots,"no-auth",{key:1})]))}}),O={class:"flex flex-col gap-4 p-4"},Q={class:"space-y-2"},W={class:"space-x-2"},X={class:"flex-col-start space-y-2"},Y={class:"text-sm space-y-2"},ts=K({__name:"index",setup(P){const r=M(),a=R(),u=U(),{auth:S,authAll:N}=$();async function V(d){await u.login({account:d,password:""}),await u.getPermissions()}function D(){r.push({path:"/feature/permission/test"})}function x(d){S(d)?C({type:"success",message:"校验通过"}):C({type:"danger",message:"校验不通过"})}function F(d){N(d)?C({type:"success",message:"校验通过"}):C({type:"danger",message:"校验不通过"})}return(d,s)=>{const v=H,f=G,g=J,L=_,w=j("auth");return o(),m(L,{navbar:"","navbar-start-side":"back"},{default:e(()=>[n("div",O,[l(a).settings.app.enablePermission?(o(),m(v,{key:1,title:"切换账号",class:"m-0"},{default:e(()=>[n("div",Q,[n("div",W,[(o(),b(q,null,z([{label:"admin",value:"admin"},{label:"test",value:"test"},{label:"hooray(无权限)",value:"hooray"}],(p,T)=>i(f,{key:T,variant:l(u).account===p.value?"default":"outline",onClick:Z=>V(p.value)},{default:e(()=>[t(B(p.label),1)]),_:2},1032,["variant","onClick"])),64))]),n("div",null,"当前账号权限："+B(l(u).permissions),1)])]),_:1})):(o(),m(v,{key:0,class:"m-0"},{default:e(()=>s[4]||(s[4]=[t(" 请到 settings.ts 里设置并开启权限功能，再进入该页面查看演示 ")])),_:1})),l(a).settings.app.enablePermission?(o(),m(v,{key:2,title:"路由鉴权",class:"m-0"},{default:e(()=>[i(f,{onClick:D},{default:e(()=>s[5]||(s[5]=[t(" 跳转页面 ")])),_:1})]),_:1})):k("",!0),l(a).settings.app.enablePermission?(o(),m(v,{key:3,title:"鉴权指令",class:"m-0"},{default:e(()=>[n("div",X,[y((o(),b("div",null,s[6]||(s[6]=[t(" 如果你有 permission.browse 权限则能看到这句话 ")]))),[[w,"permission.browse"]]),y((o(),b("div",null,s[7]||(s[7]=[t(" 如果你有 permission.create 权限则能看到这句话 ")]))),[[w,"permission.create"]]),y((o(),b("div",null,s[8]||(s[8]=[t(" 如果你有 permission.browse 或 permission.create 权限则能看到这句话 ")]))),[[w,["permission.browse","permission.create"]]]),y((o(),b("div",null,s[9]||(s[9]=[t(" 如果你有 permission.browse 和 permission.create 权限则能看到这句话 ")]))),[[w,["permission.browse","permission.create"],void 0,{all:!0}]])])]),_:1})):k("",!0),l(a).settings.app.enablePermission?(o(),m(v,{key:4,title:"鉴权组件",class:"m-0"},{default:e(()=>[n("div",Y,[n("div",null,[s[12]||(s[12]=t(" 你 ")),i(g,{value:"permission.browse"},{"no-auth":e(()=>s[10]||(s[10]=[n("b",null,"没有",-1)])),default:e(()=>[s[11]||(s[11]=n("b",null,"有",-1))]),_:1}),s[13]||(s[13]=t(" permission.browse 权限 "))]),n("div",null,[s[16]||(s[16]=t(" 你 ")),i(g,{value:"permission.create"},{"no-auth":e(()=>s[14]||(s[14]=[n("b",null,"没有",-1)])),default:e(()=>[s[15]||(s[15]=n("b",null,"有",-1))]),_:1}),s[17]||(s[17]=t(" permission.create 权限 "))]),n("div",null,[s[20]||(s[20]=t(" 你 ")),i(g,{value:["permission.browse","permission.create"]},{"no-auth":e(()=>s[18]||(s[18]=[n("b",null,"没有",-1)])),default:e(()=>[s[19]||(s[19]=n("b",null,"有",-1))]),_:1}),s[21]||(s[21]=t(" permission.browse 或 permission.create 权限 "))]),n("div",null,[s[24]||(s[24]=t(" 你 ")),i(g,{value:["permission.browse","permission.create"],all:""},{"no-auth":e(()=>s[22]||(s[22]=[n("b",null,"没有",-1)])),default:e(()=>[s[23]||(s[23]=n("b",null,"有",-1))]),_:1}),s[25]||(s[25]=t(" permission.browse 和 permission.create 权限 "))])])]),_:1})):k("",!0),l(a).settings.app.enablePermission?(o(),m(v,{key:5,title:"鉴权函数",class:"m-0","main-class":"flex flex-col gap-2"},{default:e(()=>[i(f,{variant:"outline",onClick:s[0]||(s[0]=p=>x("permission.browse"))},{default:e(()=>s[26]||(s[26]=[t(" 校验 browse 权限 ")])),_:1}),i(f,{variant:"outline",onClick:s[1]||(s[1]=p=>x("permission.create"))},{default:e(()=>s[27]||(s[27]=[t(" 校验 create 权限 ")])),_:1}),i(f,{variant:"outline",onClick:s[2]||(s[2]=p=>x(["permission.browse","permission.create"]))},{default:e(()=>s[28]||(s[28]=[t(" 校验 browse 或 create 权限 ")])),_:1}),i(f,{variant:"outline",onClick:s[3]||(s[3]=p=>F(["permission.browse","permission.create"]))},{default:e(()=>s[29]||(s[29]=[t(" 校验 browse 和 create 权限 ")])),_:1})]),_:1})):k("",!0)])]),_:1})}}});export{ts as default};
