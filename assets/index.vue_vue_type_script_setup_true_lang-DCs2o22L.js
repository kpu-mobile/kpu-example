
/**
 * 由 Kpu-mobile 提供技术支持
 * Powered by Kpu-mobile
 * https://kpu-mobile.kpui.top/
 */
    
import{d as c,y as _,x as $,r as h,c as d,o as p,w as n,C as f,u as s,P as v,R as g,p as w,j as A,h as x,a2 as b,a3 as k,a4 as R,q as y,s as B,a5 as z,a6 as L,E as M,a7 as P,b as C,e as j,t as I}from"./index-CEhcQr1Q.js";const[S,F]=$("AvatarRoot"),N=c({__name:"AvatarRoot",props:{asChild:{type:Boolean},as:{default:"span"}},setup(t){return _(),F({imageLoadingStatus:h("loading")}),(e,a)=>(p(),d(s(v),{"as-child":e.asChild,as:e.as},{default:n(()=>[f(e.$slots,"default")]),_:3},8,["as-child","as"]))}}),T=c({__name:"AvatarFallback",props:{delayMs:{default:0},asChild:{type:Boolean},as:{default:"span"}},setup(t){const e=t,a=S();_();const o=h(!1);let r;return g(a.imageLoadingStatus,l=>{l==="loading"&&(o.value=!1,e.delayMs?r=setTimeout(()=>{o.value=!0,clearTimeout(r)},e.delayMs):o.value=!0)},{immediate:!0}),(l,m)=>o.value&&s(a).imageLoadingStatus.value!=="loaded"?(p(),d(s(v),{key:0,"as-child":l.asChild,as:l.as},{default:n(()=>[f(l.$slots,"default")]),_:3},8,["as-child","as"])):w("",!0)}});function q(t,e){const a=h("idle"),o=h(!1),r=l=>()=>{o.value&&(a.value=l)};return A(()=>{o.value=!0,g([()=>t.value,()=>e==null?void 0:e.value],([l,m])=>{if(!l)a.value="error";else{const i=new window.Image;a.value="loading",i.onload=r("loaded"),i.onerror=r("error"),i.src=l,m&&(i.referrerPolicy=m)}},{immediate:!0})}),x(()=>{o.value=!1}),a}const D=c({__name:"AvatarImage",props:{src:{},referrerPolicy:{},asChild:{type:Boolean},as:{default:"img"}},emits:["loadingStatusChange"],setup(t,{emit:e}){const a=t,o=e,{src:r,referrerPolicy:l}=b(a);_();const m=S(),i=q(r,l);return g(i,u=>{o("loadingStatusChange",u),u!=="idle"&&(m.imageLoadingStatus.value=u)},{immediate:!0}),(u,G)=>k((p(),d(s(v),{role:"img","as-child":u.asChild,as:u.as,src:s(r),"referrer-policy":s(l)},{default:n(()=>[f(u.$slots,"default")]),_:3},8,["as-child","as","src","referrer-policy"])),[[R,s(i)==="loaded"]])}}),E=c({__name:"Avatar",props:{class:{},size:{default:"sm"},shape:{default:"circle"}},setup(t){const e=t;return(a,o)=>(p(),d(s(N),{class:y(s(B)(s(U)({size:a.size,shape:a.shape}),e.class))},{default:n(()=>[f(a.$slots,"default")]),_:3},8,["class"]))}}),V=c({__name:"AvatarFallback",props:{delayMs:{},asChild:{type:Boolean},as:{}},setup(t){const e=t;return(a,o)=>(p(),d(s(T),z(L(e)),{default:n(()=>[f(a.$slots,"default")]),_:3},16))}}),K=c({__name:"AvatarImage",props:{src:{},referrerPolicy:{},asChild:{type:Boolean},as:{}},setup(t){const e=t;return(a,o)=>(p(),d(s(D),M(e,{class:"h-full w-full object-cover"}),{default:n(()=>[f(a.$slots,"default")]),_:3},16))}}),U=P("inline-flex items-center justify-center font-normal text-foreground select-none shrink-0 bg-secondary overflow-hidden",{variants:{size:{sm:"h-10 w-10 text-xs",base:"h-16 w-16 text-2xl",lg:"h-32 w-32 text-5xl"},shape:{circle:"rounded-full",square:"rounded-md"}}}),J=c({name:"KmAvatar",__name:"index",props:{src:{},fallback:{},shape:{},class:{}},setup(t){const e=t;return(a,o)=>(p(),d(s(E),{shape:a.shape,class:y(e.class)},{default:n(()=>[C(s(K),{src:a.src},null,8,["src"]),C(s(V),{class:"inline-flex"},{default:n(()=>[f(a.$slots,"default",{},()=>[j(I(a.fallback),1)])]),_:3})]),_:3},8,["shape","class"]))}});export{J as _};
